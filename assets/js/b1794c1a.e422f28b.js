"use strict";(self.webpackChunkflojoy_doc=self.webpackChunkflojoy_doc||[]).push([[90021],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>f});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),d=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=d(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=d(n),c=r,f=u["".concat(p,".").concat(c)]||u[c]||m[c]||o;return n?a.createElement(f,i(i({ref:t},s),{},{components:n})):a.createElement(f,i({ref:t},s))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},21051:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=n(87462),r=(n(67294),n(3905));const o={sidebar_position:6,id:"node-api-reference",title:"Flojoy Node API Reference",description:"API reference for developing Flojoy nodes in Python."},i=void 0,l={unversionedId:"custom-nodes/node-api-reference",id:"custom-nodes/node-api-reference",title:"Flojoy Node API Reference",description:"API reference for developing Flojoy nodes in Python.",source:"@site/docs/custom-nodes/node-api-reference.md",sourceDirName:"custom-nodes",slug:"/custom-nodes/node-api-reference",permalink:"/custom-nodes/node-api-reference",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,id:"node-api-reference",title:"Flojoy Node API Reference",description:"API reference for developing Flojoy nodes in Python."},sidebar:"main",previous:{title:"Contributing Nodes",permalink:"/custom-nodes/contributing-nodes"}},p={},d=[{value:"Decorator parameters",id:"decorator-parameters",level:2},{value:"<code>node_type</code>",id:"node_type",level:3},{value:"<code>deps</code>",id:"deps",level:3},{value:"<code>inject_node_metadata</code>",id:"inject_node_metadata",level:3},{value:"Inputs and outputs",id:"inputs-and-outputs",level:2},{value:"Unions",id:"unions",level:3},{value:"Optionals",id:"optionals",level:3},{value:"<code>Any</code> type",id:"any-type",level:3},{value:"Arbitrary number of inputs",id:"arbitrary-number-of-inputs",level:3},{value:"Multiple outputs",id:"multiple-outputs",level:3},{value:"Parameters",id:"parameters",level:2},{value:"Select",id:"select",level:3},{value:"Parameter type wrappers",id:"parameter-type-wrappers",level:3},{value:"<code>DefaultParams</code>",id:"defaultparams",level:3}],s={toc:d},u="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"decorator-parameters"},"Decorator parameters"),(0,r.kt)("h3",{id:"node_type"},(0,r.kt)("inlineCode",{parentName:"h3"},"node_type")),(0,r.kt)("p",null,"By default, Flojoy will look at which part of the directory tree the node is located in to determine the type of the node. This is purely for styling purposes. If you would like to override this, pass the ",(0,r.kt)("inlineCode",{parentName:"p"},"node_type")," parameter to the ",(0,r.kt)("inlineCode",{parentName:"p"},"flojoy")," decorator."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'@flojoy(node_type="SIMULATIONS")\ndef MY_NODE(default: OrderedPair) -> OrderedPair:\n    ...\n')),(0,r.kt)("h3",{id:"deps"},(0,r.kt)("inlineCode",{parentName:"h3"},"deps")),(0,r.kt)("p",null,"If your node requires pip dependencies not installed by default with Flojoy, they can be specified in the decorator so they can be installed before running the flow chart."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import torch\n\n@flojoy(deps={'torch':'2.0.1'})\ndef TORCH_NODE(default: Matrix) -> Matrix:\n    ...\n")),(0,r.kt)("h3",{id:"inject_node_metadata"},(0,r.kt)("inlineCode",{parentName:"h3"},"inject_node_metadata")),(0,r.kt)("p",null,"Whether or not to pass ",(0,r.kt)("inlineCode",{parentName:"p"},"DefaultParams")," to the function. See ",(0,r.kt)("a",{parentName:"p",href:"#defaultparams"},"Parameters#DefaultParams")),(0,r.kt)("h2",{id:"inputs-and-outputs"},"Inputs and outputs"),(0,r.kt)("p",null,"Inputs will appear on nodes marked with the parameter name they were given in the Python function. If you only have 1 input and do not wish for a name to appear, the parameter should be given the name ",(0,r.kt)("inlineCode",{parentName:"p"},"default"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy\ndef SINE(default: OrderedPair) -> OrderedPair:\n    ...\n")),(0,r.kt)("h3",{id:"unions"},"Unions"),(0,r.kt)("p",null,"Node inputs or outputs with multiple possible types can be indicated with a type union. Note that the Flojoy editor's type checking will allow a connection if there is any overlap at all between two types. (For example, passing ",(0,r.kt)("inlineCode",{parentName:"p"},"Matrix | DataFrame | Greyscale")," to an input of type ",(0,r.kt)("inlineCode",{parentName:"p"},"Matrix | OrderedPair | OrderedTriple")," is allowed)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy\ndef UNIONS(\n    foo: Matrix | DataFrame | Greyscale,     # Preferred syntax, use this\n    bar: Union[Matrix, DataFrame, Greyscale] # This also works\n) -> OrderedPair | OrderedTriple:\n    ...\n")),(0,r.kt)("h3",{id:"optionals"},"Optionals"),(0,r.kt)("p",null,"If an input is not required, mark it with the ",(0,r.kt)("inlineCode",{parentName:"p"},"Optional")," type hint and give it a default value of ",(0,r.kt)("inlineCode",{parentName:"p"},"None"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy\ndef RAND(default: Optional[OrderedPair] = None) -> OrderedPair:\n    ...\n")),(0,r.kt)("h3",{id:"any-type"},(0,r.kt)("inlineCode",{parentName:"h3"},"Any")," type"),(0,r.kt)("p",null,"If you want a node to be able to take any kind of ",(0,r.kt)("inlineCode",{parentName:"p"},"DataContainer"),", simply use ",(0,r.kt)("inlineCode",{parentName:"p"},"DataContainer")," as the type annotation. Note that it is always preferred to specify a more specific type when possible."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy\ndef FEEDBACK(default: DataContainer) -> DataContainer:\n    ...\n")),(0,r.kt)("h3",{id:"arbitrary-number-of-inputs"},"Arbitrary number of inputs"),(0,r.kt)("p",null,"To allow a node to accept an arbitrary number of inputs, make the node type a ",(0,r.kt)("inlineCode",{parentName:"p"},"list")," of ",(0,r.kt)("inlineCode",{parentName:"p"},"DataContainer"),"s. In this example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"ADD")," node can accept any number of inputs through input ",(0,r.kt)("inlineCode",{parentName:"p"},"b"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy\ndef ADD(a: OrderedPair, b: list[OrderedPair]) -> OrderedPair:\n    ...\n")),(0,r.kt)("h3",{id:"multiple-outputs"},"Multiple outputs"),(0,r.kt)("p",null,"For a node to return multiple ",(0,r.kt)("inlineCode",{parentName:"p"},"DataContainer"),"s, declare a class that inherits from ",(0,r.kt)("inlineCode",{parentName:"p"},"TypedDict")," and make sure all of the fields are ",(0,r.kt)("inlineCode",{parentName:"p"},"DataContainer"),"s. The names given to the outputs will be displayed on the node in the Flojoy editor."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from typing import TypedDict\n\nclass FooOutput(TypedDict):\n    output1: OrderedPair\n    output2: Matrix\n\n@flojoy\ndef FOO(default: OrderedPair) -> FooOutput:\n    x = default.x\n    y = default.y * 2\n    mat = np.array([[1,2], [3,4]])\n\n    return FooOutput(output1=OrderedPair(x, y), output2=mat)\n")),(0,r.kt)("h2",{id:"parameters"},"Parameters"),(0,r.kt)("p",null,"Parameters and their default values can be specified using regular Python syntax. It is good to specify a default value in most cases. The list of allowed parameter types are as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"int")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"float")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"str"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bool"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"list[int]"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"list[float]"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"list[str]"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Literal")," (for Select parameters)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"NodeReference")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Array")," (a wrapper for ",(0,r.kt)("inlineCode",{parentName:"li"},"list[str | int | float]"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DefaultParams")," (a special type carrying metadata about a node)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'def MY_NODE(\n    default: OrderedPair,\n    n: int = 5,\n    foo: str = "bar",\n    colors: list[str] = ["red", "green", "blue"]\n) -> OrderedPair:\n    ...\n')),(0,r.kt)("h3",{id:"select"},"Select"),(0,r.kt)("p",null,"A ",(0,r.kt)("inlineCode",{parentName:"p"},"Select")," parameter (a dropdown list of options in the editor) can be specified using ",(0,r.kt)("inlineCode",{parentName:"p"},"Literal")," from Python's ",(0,r.kt)("inlineCode",{parentName:"p"},"typing")," module."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'def PLOTLY_DATASET(dataset_key: Literal["wind", "iris", "carshare"] = "wind"): -> DataFrame:\n    ...\n')),(0,r.kt)("h3",{id:"parameter-type-wrappers"},"Parameter type wrappers"),(0,r.kt)("p",null,"These are types that carry special meaning in Flojoy but just wrap regular Python types. The inner value can be accessed by calling ",(0,r.kt)("inlineCode",{parentName:"p"},".unwrap()")," on the object."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"NodeReference"),": A reference to another node in the flow chart"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Array"),": A generic array (",(0,r.kt)("inlineCode",{parentName:"p"},"list[str | int | float]"),")"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy\ndef GOTO(default: DataContainer, goto_node_id: NodeReference):\n    ref = goto_node_id.unwrap()\n    ...\n")),(0,r.kt)("h3",{id:"defaultparams"},(0,r.kt)("inlineCode",{parentName:"h3"},"DefaultParams")),(0,r.kt)("p",null,"A special parameter type that contains metadata about a node. This class has the following fields:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"node_id"),": The ID of the node in the flow chart. This has the format ",(0,r.kt)("inlineCode",{parentName:"li"},'"{NODE_NAME}-{uuid}"')),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"job_id"),": The ID of the job running this node."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"jobset_id"),": The ID of the current flow chart run. (This is different every run)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"node_type"),": The type of the node (ex: ",(0,r.kt)("inlineCode",{parentName:"li"},'"SIMULATIONS"'),")")),(0,r.kt)("p",null,"In order to access this information, you must add a parameter named ",(0,r.kt)("inlineCode",{parentName:"p"},"default_params")," with a type annotation of ",(0,r.kt)("inlineCode",{parentName:"p"},"DefaultParams"),", and pass ",(0,r.kt)("inlineCode",{parentName:"p"},"inject_node_metadata=True")," to the ",(0,r.kt)("inlineCode",{parentName:"p"},"flojoy")," decorator."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@flojoy(inject_node_metadata=True)\ndef LOOP(\n    default: DataContainer, default_params: DefaultParams, num_loops: int = -1\n) -> LoopOutput:\n    ...\n")))}m.isMDXComponent=!0}}]);