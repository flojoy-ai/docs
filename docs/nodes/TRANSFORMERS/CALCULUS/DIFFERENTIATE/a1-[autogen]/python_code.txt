from flojoy import flojoy, OrderedPair
import numpy as np


@flojoy
def DIFFERENTIATE(default: OrderedPair) -> OrderedPair:
    
    input_x = default.x
    input_y = default.y

    if type(input_x) != np.ndarray:
        raise ValueError(f"Invalid type for x:{type(input_x)}")
    elif type(input_y) != np.ndarray:
        raise ValueError(f"Invalid type for y:{type(input_y)}")
    elif len(input_x) != len(input_y):
        raise ValueError(f"Invalid inputs, x:{input_x} y:{input_y}")

    differentiate = np.diff(input_y) / np.diff(input_x)

    return OrderedPair(x=input_x, y=differentiate)
