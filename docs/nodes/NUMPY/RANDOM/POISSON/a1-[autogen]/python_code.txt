import numpy as np
from flojoy import flojoy, DataContainer
from typing import Optional, Union, Tuple, List


@flojoy
def POISSON(dc: list, params: dict) -> DataContainer:
    
    # Extract optional arguments
    size: str = params.get("size", "dc[0].y.shape")
    lam: float = params.get("lam", 1.0)

    # Draw samples from the Poisson distribution
    out = np.random.poisson(lam=float(lam), size=eval(size))

    # Return custom class
    return DataContainer(x=dc[0].y, y=out)
