from flojoy import flojoy, DataFrame, Plotly
import plotly.graph_objects as go
import pandas as pd
from nodes.VISUALIZERS.template import plot_layout


@flojoy
def TABLE(default: DataFrame) -> Plotly:
    
    layout = plot_layout(title="TABLE")
    if not isinstance(default, DataFrame):
        raise ValueError(
            f"unsupported DataContainer type passed for TABLE: {default.type}"
        )

    df = default.m
    fig = go.Figure(
        data=[
            go.Table(
                header=dict(values=list(df.columns), align="left"),
                cells=dict(values=[df[col] for col in df.columns], align="left"),
            )
        ],
        layout=layout,
    )
    return Plotly(fig=fig)
